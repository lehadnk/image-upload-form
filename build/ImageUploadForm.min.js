!function(t){function e(e,n,r){var a=t(o(e)).parent(),d=t("<div></div>").prependTo(a).addClass("alert alert-danger alert-dismissible").hide().show("fade"),u=function(){t(d).hide("fade",function(){t(d).remove()})};setTimeout(u,3e3),i(d,"<button>Ã—</button>","close").on("click",u),i(d,'<h4><i class="icon fa fa-ban"></i>'+n+"</h4>",""),d.append(r)}function n(){var n=new FormData;n.append("file",t(this)[0].files[0]),n.append("action","upload");var r=t(this).data("url"),i=l(o(this));f(i),t.ajax({url:r,type:"POST",data:n,processData:!1,contentType:!1,dataType:"json",success:function(t){t.src&&t.id&&t.status||(t.error?e(i,"Error!",t.error):e(i,"Error!","It looks like there's something wrong with server response. Please notice server administrator about it."),a(i)),h(i),c(i,m(t)),s(i)},error:function(){e(i,"Error!","Internal server error."),a(i)},timeout:15e3})}function r(){var n=t(t(this).parents("."+C.thumbContainer)[0]).find("img").data("id"),r=t(this).data("url"),o=t(this).parent();f(o),t.ajax({url:r,type:"POST",data:{action:"delete",id:n},dataType:"json",success:function(n){h(o),n.error&&e(o,"Error!",n.error),n.status&&a(t(o).parents("."+C.thumbContainer))},error:function(){h(o),e(o,"Error!","Internal server error.")},timeout:15e3})}function a(e){t(e).hide("fade",function(){var n=e.parent();t(e).remove(),s(n)})}function o(e){return t(t(e).parents("."+C.pluginContainer)[0]).find("."+C.imageContainerClass)[0]}function i(e,n,r){return t(n).appendTo(e).addClass(r)}function d(e){var n=t(e).children("img");return n.each(function(e,n){t(n).hide()}),n}function u(t,e){e.each(function(e,n){p(t,n)})}function s(e){var n=t(t(e).parents("."+C.pluginContainer)[0]).find("."+C.footerHintClass)[0],r=t(o(e)).children().length-1;t(n).html(r+" images total")}function l(e){t(e).parent().show();var n=t(e).children("."+C.imagePatternClass).clone(!0);return n.appendTo(e),n.removeClass(C.imagePatternClass).hide().fadeIn("slow"),n}function c(e,n){t(n).appendTo(t(e).children("."+C.imageThumbContainer)[0]),t(n).fadeIn("slow")}function f(t){var e=i(t,"<div></div>","overlay");i(e,"<i></i>","fa fa-refresh fa-spin")}function h(e){t(e).children(".overlay").remove()}function m(e){return t("<img>").attr("src",e.src).data("id",e.id).addClass(C.thumb).hide()}function p(t,e){var n=l(t);c(n,e)}function v(e,a){var o=d(e),l=a.style,c=i(e,"<div></div>",l.header.container);i(c,"<h3>"+a.text.formHeader+"</h3>",l.header.header);var f=i(c,"<div></div>",l.header.buttonsContainer),h=i(f,'<input type="file"></input>',l.header.addImageButton);t(h).on("change",n),t(h).data("url",a.uploadUrl);var m=i(e,"<div></div>",l.content.container),p=i(m,"<div></div>",l.content.row).addClass(C.imageContainerClass),v=i(p,"<div></div>",l.content.thumb.container).addClass(C.imagePatternClass);i(v,"<div></div>",l.content.thumb.thumbContainer).addClass(C.imageThumbContainer);var b=i(v,"<div></div>",l.content.thumb.footerContainer),g=i(b,"<div></div>",l.content.thumb.footerButtonsContainer),x=i(g,"<button>"+a.text.deleteButton+"</button>",l.content.thumb.deleteButton);x.on("click",r),x.data("url",a.deleteUrl),0==o.length?t(m).hide():u(p,o,a,l);var y=i(e,"<div></div>",l.footer.container);i(y,"<p></p>",l.footer.infoBlock).addClass(C.footerHintClass),s(y)}function b(e,n){t(e).addClass(C.pluginContainer),v(e,n)}var C={imageContainerClass:"iuf-image-container",footerHintClass:"iuf-footer-hint",imagePatternClass:"iuf-image-pattern",imageThumbContainer:"iuf-image-thumb-container",thumbContainer:"iuf-thumb-container",pluginContainer:"iuf-plugin-container",thumb:"iuf-thumb-image"};t.fn.imageUploadForm=function(e){var n=t.extend({maxFiles:7,style:{header:{container:"box-header with-border",header:"box-title",buttonsContainer:"box-tools pull-right",addImageButton:"btn btn-primary btn-sm"},content:{container:"box-body",row:"row",thumb:{container:"col-lg-3 col-md-6 col-xs-12 iuf-thumb-container",thumbContainer:"thumbnail no-margin iuf-preview-container",thumb:"iuf-thumb-image",footerContainer:"box box-solid no-margin iuf-thumb-footer",footerButtonsContainer:"box-footer",deleteButton:"btn btn-danger"}},footer:{container:"box-footer",infoBlock:"help-block"}},text:{formHeader:"Image Upload",deleteButton:"Delete"},uploadUrl:"",deleteUrl:""},e);b(this,n)}}(jQuery);